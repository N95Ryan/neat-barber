---
import Layout from "../../layouts/Layout.astro";
import BlogNavbar from "../../components/BlogNavbar.astro";
import Footer from "../../components/Footer.astro";
import BlogHeader from "../../components/BlogHeader.astro";
import { getPostBySlug, getAllPosts } from "../../data/blog-posts";

// Récupérer le slug depuis l'URL
const { slug } = Astro.params;

// Récupérer l'article correspondant au slug
const post = getPostBySlug(slug);

// Gérer le cas où l'article n'existe pas
if (!post) {
  return Astro.redirect("/le-mag");
}

// Récupérer les articles liés (3 articles aléatoires différents de l'article courant)
const allPosts = getAllPosts();
const relatedPosts = allPosts
  .filter((p) => p.id !== post.id)
  .sort(() => Math.random() - 0.5)
  .slice(0, 3);
---

<Layout title={`${post.title} - NEAT Barber Paris`}>
  <!-- Navbar pour les pages blog -->
  <BlogNavbar />

  <!-- Blog Header Section -->
  <BlogHeader title={post.title} />

  <!-- Blog Single Section -->
  <section class="blog-single">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-10">
          <!-- Image principale -->
          <div class="blog-single-image">
            <img src={post.image} alt={post.title} class="img-fluid" />
          </div>

          <!-- Métadonnées -->
          <div class="blog-single-meta">
            <div class="blog-single-category">{post.category}</div>
            <div class="blog-single-date">
              <i class="far fa-calendar-alt"></i>
              {post.date}
            </div>
          </div>

          <!-- Contenu de l'article -->
          <div class="blog-single-content">
            <p>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed
              euismod, nisl vel ultricies lacinia, nisl nisl aliquam nisl, eu
              aliquam nisl nisl eu nisl. Sed euismod, nisl vel ultricies
              lacinia, nisl nisl aliquam nisl, eu aliquam nisl nisl eu nisl.
            </p>

            <p>
              Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam nisl,
              eu aliquam nisl nisl eu nisl. Sed euismod, nisl vel ultricies
              lacinia, nisl nisl aliquam nisl, eu aliquam nisl nisl eu nisl. Sed
              euismod, nisl vel ultricies lacinia, nisl nisl aliquam nisl, eu
              aliquam nisl nisl eu nisl.
            </p>

            <h2>Les avantages de {post.title.toLowerCase()}</h2>

            <p>
              Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam nisl,
              eu aliquam nisl nisl eu nisl. Sed euismod, nisl vel ultricies
              lacinia, nisl nisl aliquam nisl, eu aliquam nisl nisl eu nisl.
            </p>

            <ul>
              <li>Avantage 1 : Lorem ipsum dolor sit amet</li>
              <li>Avantage 2 : Consectetur adipiscing elit</li>
              <li>Avantage 3 : Sed do eiusmod tempor incididunt</li>
              <li>Avantage 4 : Ut labore et dolore magna aliqua</li>
            </ul>

            <p>
              Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam nisl,
              eu aliquam nisl nisl eu nisl. Sed euismod, nisl vel ultricies
              lacinia, nisl nisl aliquam nisl, eu aliquam nisl nisl eu nisl.
            </p>

            <blockquote>
              "Chez NEAT, nous croyons que chaque coupe de cheveux est une œuvre
              d'art qui reflète la personnalité unique de chaque client."
            </blockquote>

            <h3>Comment appliquer ces conseils au quotidien</h3>

            <p>
              Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam nisl,
              eu aliquam nisl nisl eu nisl. Sed euismod, nisl vel ultricies
              lacinia, nisl nisl aliquam nisl, eu aliquam nisl nisl eu nisl.
            </p>

            <p>
              Sed euismod, nisl vel ultricies lacinia, nisl nisl aliquam nisl,
              eu aliquam nisl nisl eu nisl. Sed euismod, nisl vel ultricies
              lacinia, nisl nisl aliquam nisl, eu aliquam nisl nisl eu nisl.
            </p>

            <!-- Bouton de retour -->
            <div class="blog-back-btn mt-5">
              <a href="/le-mag" class="btn-back">
                <i class="fas fa-arrow-left"></i> Retour aux articles
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Articles liés -->
  <section class="related-posts">
    <div class="container">
      <div class="row">
        <div class="col-12 text-center mb-5">
          <h2 class="related-posts-title">Articles similaires</h2>
        </div>
      </div>

      <div class="row">
        {
          relatedPosts.map((relatedPost) => (
            <div class="col-lg-4 col-md-6 mb-4">
              <div class="blog-card">
                <div class="blog-image">
                  <img
                    src={relatedPost.image}
                    alt={relatedPost.title}
                    class="img-fluid"
                  />
                  <div class="blog-date">{relatedPost.date}</div>
                </div>
                <div class="blog-content">
                  <div class="blog-category">{relatedPost.category}</div>
                  <h3 class="blog-title">
                    <a href={`/le-mag/${relatedPost.slug}`}>
                      {relatedPost.title}
                    </a>
                  </h3>
                  <p class="blog-excerpt">{relatedPost.excerpt}</p>
                  <a href={`/le-mag/${relatedPost.slug}`} class="read-more">
                    Lire l'article <i class="fas fa-arrow-right" />
                  </a>
                </div>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <Footer />
</Layout>

<style>
  /* Styles pour l'article individuel */
  .blog-single {
    padding: 80px 0;
    background-color: #ffffff;
  }

  .blog-single-image {
    width: 100%;
    height: 400px;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 30px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  }

  .blog-single-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .blog-single-meta {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
    gap: 20px;
  }

  .blog-single-category {
    background-color: #4a5d4a;
    color: #ffffff;
    font-size: 0.8rem;
    font-weight: 600;
    padding: 5px 15px;
    border-radius: 20px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .blog-single-date {
    color: #6c757d;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
  }

  .blog-single-date i {
    margin-right: 6px;
  }

  .blog-single-content {
    font-size: 1.05rem;
    line-height: 1.8;
    color: #495057;
  }

  .blog-single-content p {
    margin-bottom: 20px;
  }

  .blog-single-content h2 {
    font-size: 1.8rem;
    font-weight: 600;
    margin: 40px 0 20px;
    color: #2a342a;
  }

  .blog-single-content h3 {
    font-size: 1.5rem;
    font-weight: 600;
    margin: 30px 0 15px;
    color: #2a342a;
  }

  .blog-single-content ul,
  .blog-single-content ol {
    margin-bottom: 20px;
    padding-left: 20px;
  }

  .blog-single-content li {
    margin-bottom: 10px;
  }

  .blog-single-content blockquote {
    border-left: 4px solid #4a5d4a;
    padding: 15px 20px;
    margin: 30px 0;
    background-color: #f8f9fa;
    font-style: italic;
    color: #2a342a;
  }

  .btn-back {
    display: inline-flex;
    align-items: center;
    color: #4a5d4a;
    font-weight: 600;
    font-size: 1rem;
    text-decoration: none;
    transition: all 0.3s ease;
    padding: 10px 20px;
    border: 1px solid #4a5d4a;
    border-radius: 25px;
  }

  .btn-back i {
    margin-right: 8px;
    transition: transform 0.3s ease;
  }

  .btn-back:hover {
    background-color: #4a5d4a;
    color: #ffffff;
  }

  .btn-back:hover i {
    transform: translateX(-3px);
  }

  /* Styles pour les articles reliés */
  .related-posts {
    padding: 60px 0;
    background-color: #f8f9fa;
  }

  .related-posts-title {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 40px;
    text-align: center;
    color: #2a342a;
    position: relative;
  }

  .related-posts-title::after {
    content: "";
    position: absolute;
    bottom: -15px;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 3px;
    background-color: #4a5d4a;
    border-radius: 2px;
  }

  /* Styles pour les cartes de blog */
  .blog-card {
    background-color: #ffffff;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .blog-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
  }

  .blog-image {
    position: relative;
    overflow: hidden;
    height: 220px;
  }

  .blog-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .blog-card:hover .blog-image img {
    transform: scale(1.05);
  }

  .blog-date {
    position: absolute;
    bottom: 0;
    left: 0;
    background-color: rgba(42, 52, 42, 0.85);
    color: #ffffff;
    font-size: 0.75rem;
    font-weight: 500;
    padding: 6px 12px;
    border-top-right-radius: 10px;
  }

  .blog-content {
    padding: 25px;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }

  .blog-category {
    display: inline-block;
    background-color: #4a5d4a;
    color: #ffffff;
    font-size: 0.75rem;
    font-weight: 600;
    padding: 5px 12px;
    border-radius: 20px;
    margin-bottom: 15px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .blog-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 15px;
    line-height: 1.4;
  }

  .blog-title a {
    color: #2a342a;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .blog-title a:hover {
    color: #4a5d4a;
  }

  .blog-excerpt {
    color: #6c757d;
    margin-bottom: 20px;
    font-size: 0.95rem;
    line-height: 1.6;
    flex-grow: 1;
  }

  .read-more {
    display: inline-flex;
    align-items: center;
    color: #4a5d4a;
    font-weight: 600;
    font-size: 0.9rem;
    text-decoration: none;
    transition: all 0.3s ease;
    margin-top: auto;
  }

  .read-more i {
    margin-left: 8px;
    transition: transform 0.3s ease;
  }

  .read-more:hover {
    color: #2a342a;
  }

  .read-more:hover i {
    transform: translateX(3px);
  }

  /* Responsive */
  @media (max-width: 991px) {
    .blog-single {
      padding: 60px 0;
    }

    .blog-single-title {
      font-size: 2rem;
    }

    .blog-single-image {
      height: 350px;
    }

    .related-posts {
      padding: 50px 0;
    }
  }

  @media (max-width: 767px) {
    .blog-single {
      padding: 50px 0;
    }

    .blog-single-title {
      font-size: 1.8rem;
    }

    .blog-single-image {
      height: 300px;
    }

    .blog-single-content {
      font-size: 1rem;
    }

    .related-posts {
      padding: 40px 0;
    }
  }

  @media (max-width: 575px) {
    .blog-single {
      padding: 40px 0;
    }

    .blog-single-title {
      font-size: 1.5rem;
    }

    .blog-single-image {
      height: 250px;
    }

    .blog-single-meta {
      flex-direction: column;
      align-items: flex-start;
      gap: 10px;
    }

    .related-posts-title {
      font-size: 1.5rem;
    }

    .blog-single-content h2 {
      font-size: 1.5rem;
    }

    .blog-single-content h3 {
      font-size: 1.3rem;
    }
  }
</style>
